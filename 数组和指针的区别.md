1.指针和数组定义、区别
1.1指针和数组定义
指针和数组都是C语言的精髓所在，对于很多C程序员来说，如果你问这样一个问题：数组和指针有什么区别？他们的答案很可能是：”数组和指针不是同一样东西吗，他们之间有什么区别啊？“；确实在极个别的情况下，数组和指针确实可以”通用“。
但是在却大多数情况下，数组和指针是两个完全不同的C语言特性。
首先，我们分别看一下，指针和数组的定义，以及他们之间的不同；指针表示C语言中某种数据类型的数据存储的内存地址，例如，指向各种整型的指针或者指向某个结构体的指针；数组表示若干个相同C语言数据类型的元素在连续内存中储存的一种形态。
1.2数组和指针的区别
好了，上面即为数组和指针的简单定义。在说明数组和指针之间的区别之前，我们先来看一个实例；
我们定义两个文件：a.c和b.c，其中，
[cpp] view plain copy
a.c文件: int array[4] = {1, 2, 3, 4}; 
3.   
b.c文件: #include <stdio.h> 
6.   
extern int *array; 
8.   
int main(void) { 
11.    int i = 0; 
12.    for (i; i <4; i++) { 
13.        printf("*array = %d", *array++); 
14.    }   
15.    return 0; 
} 
我们编译运行上面的示例程序，不出意外其无法运行。可能有的人很不理解其中原因，他们找不出问题的原因。其实根本原因就是他们认为数组和指针是相同的！其将array定义为一个4个int元素的数组，但是在b.c中却又将其声明为int型指针。其实数组和指针只是在特定的上下文环境下可以认为相同，一般情况下，他们是不同的数据类型，就像float和int类型不同一样。
下面逐步分析数组和指针之间的区别：
数组和指针本质上都代表一块内存，数组比较”直接“，数组名即代表这块内存的地址，而指针比较”含蓄“，其本身不代表任何有意义的内容，只有给它赋值后，它才真正的表示一块有意义的内存地址。这就引出了指针和数组的一个区别：定义的时机不同；数组在编译时就已经被确定下来，而指针直到运行时才能被真正的确定到底指向何方。数组就好比生在帝王家一样，一生来就有了属于自己的封地、财富(内存)，而指针需要经过编译、链接、运行时等重重考验才能获得属于自己的财富（内存)。但是，数组的这些身份(内存)一旦确定下来就不能轻易的改变了，它们(内存)会伴随数组一生；而指针则有很多的选择，在其一生他可以选择不同的生活方式，比如一个字符指针可以指向单个字符同时也可代表多个字符等。
由数组和指针的上述区别引出了它们的之间的另一个区别:访问方式不同;由于数组名直接代表其身份(数组在内存中的地址)，而指针需要间接才能知道自己的身份(通过读取其保存的地址)，所以它们的对于自己”财富“的访问方式自然就不同了，数组为直接方式，而指针位间接访问。
2.再论数组
2.1数组和指针何时相同
C语言标准对于数组和指针何时相同定义几条规则：
规则1：表达式中的数组名(与声明不同)被编译器当作一个指向数组第一个元素的指针。
规则2:下标总是与指针的偏移量相同。
规则3：在函数参数的声明中，数组名被编译器当作指向该数组第一个元素的指针。
简而言之，数组和指针的关系颇有点像诗和词关系，它们都是文学性之一，有不少共同之处，但在具体的表现形式上又各有特色。下面具体介绍这几条规则的具体含义。
2.1.1 规则1
组合规则1和规则2，就是对于数组下标的引用总是可以写成“一个指向数组的起始地址的指针加上偏移量”。例如，假如我们声明如下:
int a[10], *p, i = 2;
就可以通过下面任何一种方式访问a[i]:
p = a;p[i];
p = a;*(p+i);
p = a + i;*p;
记住：在表达式中，指针和数组是可以互换的，因为它们在编译器里的最终形式都是指针，并且都是可以进行取下标操作。
2.1.2 规则2
数组下标和指针总是相同的，为什么要这么说呢？大家可能听说过，在编写程序时，对于数组访问应该写成指针的形式，因为这样可以提高效率。对于现代的编译器而言，这个说法一般是错误的！现代编译器对于数组的访问都会自动优化为其对应的指针加偏移量的形式，所以也就没有哪种形式效率更高的说法了。实际上，数组的访问之所以改写为指针加偏移量的方式，是因为其为系统底层最基本的工作方式。
2.1.3 规则3
C语言中函数的参数基本都是“传值”调用的，唯独数组为“引用”调用方式，即数组作为函数参数时，会被编译器自动的转换为指向数组第一个元素的指针，这是编译器自动完成的。之所以这么做，其实是为了系统性能，因为数组结构占用的内存通常比较大，如果“传值”调用的话，内存拷贝会浪费大量的时间和空间，这样做得不偿失，所以数组作为函数参数时，编译器会自动将其转换为指向第一个元素的指针。
作者：d7646e4b90f1
链接：https://www.jianshu.com/p/b68088939576
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。


